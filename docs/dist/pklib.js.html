<!DOCTYPE html>
<html>
<head>
  <title>pklib.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../doc-style.css" />
  <script src="../doc-filelist.js"></script>
  <script>
    var relativeDir = "../", thisFile = "dist/pklib.js", defaultSidebar = true;
  </script>
  <script src="../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
      <div class="heading h2">
        <a href="#helpers.">Helpers.</a>
      </div>
      <div class="heading h2">
        <a href="#ajax.">Ajax.</a>
      </div>
      <div class="heading h2">
        <a href="#array.">Array.</a>
      </div>
      <div class="heading h2">
        <a href="#aspect.">Aspect.</a>
      </div>
      <div class="heading h2">
        <a href="#common.">Common.</a>
      </div>
      <div class="heading h2">
        <a href="#cookie.">Cookie.</a>
      </div>
      <div class="heading h2">
        <a href="#css.">CSS.</a>
      </div>
      <div class="heading h2">
        <a href="#dom.">DOM.</a>
      </div>
      <div class="heading h2">
        <a href="#events.">Events.</a>
      </div>
      <div class="heading h2">
        <a href="#file.">File.</a>
      </div>
      <div class="heading h2">
        <a href="#object.">Object.</a>
      </div>
      <div class="heading h2">
        <a href="#profiler.">Profiler.</a>
      </div>
      <div class="heading h2">
        <a href="#string.">String.</a>
      </div>
      <div class="heading h2">
        <a href="#ui">UI</a>
      </div>
      <div class="heading h2">
        <a href="#ui%20glass.">UI Glass.</a>
      </div>
      <div class="heading h2">
        <a href="#ui%20loader.">UI Loader.</a>
      </div>
      <div class="heading h2">
        <a href="#ui%20message.">UI Message.</a>
      </div>
      <div class="heading h2">
        <a href="#ui%20size.">UI Size.</a>
      </div>
      <div class="heading h2">
        <a href="#url.">URL.</a>
      </div>
      <div class="heading h2">
        <a href="#utilities.">Utilities.</a>
      </div>
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs">
          <h1>pklib.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1">&#182;</a>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="cm">/*jslint continue: true, nomen: true, plusplus: true, regexp: true, vars: true, white: true, indent: 4 */</span>
<span class="cm">/*global document, XMLHttpRequest, ActiveXObject, setInterval, clearInterval, setTimeout, clearTimeout, navigator */</span>

<span class="cm">/** pklib JavaScript library v2.0.0 - MIT License */</span>

<span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">root</span><span class="p">)</span> <span class="p">{</span>
    <span class="s1">&#39;use strict&#39;</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2">&#182;</a>
</div>
<p>Imports.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nb">document</span> <span class="o">=</span> <span class="nx">root</span><span class="p">.</span><span class="nb">document</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3">&#182;</a>
</div>
<p>Prototypes.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">ObjectProto</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">ArrayProto</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4">&#182;</a>
</div>
<p>Shortcuts.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">toString</span> <span class="o">=</span> <span class="nx">ObjectProto</span><span class="p">.</span><span class="nx">toString</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">isIE</span> <span class="o">=</span> <span class="p">(</span><span class="sr">/msie/</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="helpers.">
  <h2>
    <a href="#helpers." name="helpers." class="pilcrow">&#182;</a>
    Helpers.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6">&#182;</a>
</div>
<p>Basic test function. Simple assertion 2 variables.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">assert</span><span class="p">(</span><span class="nx">expression</span><span class="p">,</span> <span class="nx">comment</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">expression</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">comment</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">assert</span><span class="p">.</span><span class="nx">count</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">assert</span><span class="p">.</span><span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">pklib</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">VERSION</span><span class="o">:</span> <span class="s1">&#39;1.3&#39;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="ajax.">
  <h2>
    <a href="#ajax." name="ajax." class="pilcrow">&#182;</a>
    Ajax.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8">&#182;</a>
</div>
<p>Default time what is timeout to use function <code>pklib.ajax</code>.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">DEFAULT_TIMEOUT_TIME</span> <span class="o">=</span> <span class="mi">30</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">;</span> <span class="c1">// 30 second</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9">&#182;</a>
</div>
<p>Array contain key as url, value as ajax response.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">cache</span> <span class="o">=</span> <span class="p">[];</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10">&#182;</a>
</div>
<p>When success request.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">successHandler</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">contentType</span><span class="p">,</span>
            <span class="nx">xmlContentType</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;application/xml&#39;</span><span class="p">,</span> <span class="s1">&#39;text/xml&#39;</span><span class="p">],</span>
            <span class="nx">property</span> <span class="o">=</span> <span class="s1">&#39;responseText&#39;</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">cache</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">cache</span><span class="p">[</span><span class="nx">settings</span><span class="p">.</span><span class="nx">url</span><span class="p">]</span> <span class="o">=</span> <span class="nx">xhr</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">contentType</span> <span class="o">=</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">inArray</span><span class="p">(</span><span class="nx">contentType</span><span class="p">,</span> <span class="nx">xmlContentType</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">property</span> <span class="o">=</span> <span class="s1">&#39;responseXML&#39;</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">settings</span><span class="p">.</span><span class="nx">done</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">[</span><span class="nx">property</span><span class="p">]);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11">&#182;</a>
</div>
<p>Clear memory.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">xhr</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12">&#182;</a>
</div>
<p>When error request.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">errorHandler</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13">&#182;</a>
</div>
<p>Check if error handler is run yet.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">_run_error_handler</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14">&#182;</a>
</div>
<p>No, so we run error handler first time.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">settings</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15">&#182;</a>
</div>
<p>Set flag to no run error handler.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">xhr</span><span class="p">.</span><span class="nx">_run_error_handler</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16">&#182;</a>
</div>
<p>Use when state in request is changed or if used cache is handler to request.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">stateChangeHandler</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">status</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="nx">XMLHttpRequest</span><span class="p">.</span><span class="nx">DONE</span> <span class="o">&amp;&amp;</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">!==</span> <span class="nx">XMLHttpRequest</span><span class="p">.</span><span class="nx">UNSENT</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">status</span> <span class="o">=</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">ontimeout</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">ontimeout</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">delete</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">ontimeout</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">((</span><span class="nx">status</span> <span class="o">&gt;=</span> <span class="mi">200</span> <span class="o">&amp;&amp;</span> <span class="nx">status</span> <span class="o">&lt;</span> <span class="mi">300</span><span class="p">)</span> <span class="o">||</span> <span class="nx">status</span> <span class="o">===</span> <span class="mi">304</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">successHandler</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">errorHandlerWithAbort</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">errorHandlerWithAbort</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">abort</span><span class="p">();</span>

        <span class="nx">errorHandler</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17">&#182;</a>
</div>
<p>Handler to unusually situation - timeout.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">timeoutHandler</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">errorHandler</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18">&#182;</a>
</div>
<p>Try to create Internet Explorer XMLHttpRequest.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">createMicrosoftXhr</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">xhr</span><span class="p">;</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s1">&#39;Msxml2.XMLHTTP&#39;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">ignore</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s1">&#39;Microsoft.XMLHTTP&#39;</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">ignored</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;pklib.ajax.load: can&#39;t create XMLHttpRequest object&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">xhr</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19">&#182;</a>
</div>
<p>Try to create XMLHttpRequest.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">createXhr</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">xhr</span><span class="p">;</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">ignore</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">xhr</span> <span class="o">=</span> <span class="nx">createMicrosoftXhr</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">xhr</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20">&#182;</a>
</div>
<p>Add headers to xhr object.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">addHeadersToXhr</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">header</span><span class="p">,</span> <span class="nx">headers</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">headers</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">headers</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">header</span> <span class="k">in</span> <span class="nx">headers</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">headers</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">header</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="nx">header</span><span class="p">,</span> <span class="nx">headers</span><span class="p">[</span><span class="nx">header</span><span class="p">]);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21">&#182;</a>
</div>
<p>Add timeout service to xhr object.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">addTimeoutServiceToXhr</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">ontimeout</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">timeoutHandler</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">);</span>
        <span class="p">},</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">timeout</span><span class="p">);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22">&#182;</a>
</div>
<p>Check is response on this request is in cache.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">isResponseInCache</span><span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">cache</span><span class="p">[</span><span class="nx">settings</span><span class="p">.</span><span class="nx">url</span><span class="p">];</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23">&#182;</a>
</div>
<p>Return object what is default configuration of request.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getDefaultSettings</span><span class="p">()</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24">&#182;</a>
</div>
<p>Request settings, contain ex. headers, callback when run after
request finish. Default timeout on request is 30 seconds.
This is default timeout from popular web servers, ex. Apache, nginx.
Default request hasn't any headers.
Default cache is disabled.
Default asynchronous is enable.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;get&#39;</span><span class="p">,</span>
            <span class="nx">async</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">cache</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">url</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nx">params</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nx">timeout</span><span class="o">:</span> <span class="nx">DEFAULT_TIMEOUT_TIME</span><span class="p">,</span>
            <span class="nx">headers</span><span class="o">:</span> <span class="p">{},</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25">&#182;</a>
</div>
<p>Function run after request ended
In params exists only: response</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">done</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{},</span>
            <span class="nx">error</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{}</span>
        <span class="p">};</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">ajax</span> <span class="o">=</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26">&#182;</a>
</div>
<p>Send request to server on url defined in config.url.
Method throw exception when request have timeout on server or if
url is not set. Also, every response (if config.cache is true)
saved to hashmap by key config.url. Method on first try to can
create XMLHttpRequest if browser doesn't support, check if browser
support object ActiveXObject which is implemented in Internet
Explorer.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">load</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">settings</span> <span class="o">=</span> <span class="nx">getDefaultSettings</span><span class="p">();</span>

            <span class="nx">settings</span> <span class="o">=</span> <span class="nx">mixin</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">config</span><span class="p">);</span>
            <span class="nx">settings</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27">&#182;</a>
</div>
<p>Simple assert to check 'url' is set.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">assert</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">url</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">,</span> <span class="s1">&#39;pklib.ajax.load: @url is not defined&#39;</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28">&#182;</a>
</div>
<p>Check if we use 'cache' flag in request.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">cache</span> <span class="o">&amp;&amp;</span> <span class="nx">isResponseInCache</span><span class="p">(</span><span class="nx">settings</span><span class="p">))</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29">&#182;</a>
</div>
<p>Yes, we use, so we can return response from cache object.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">stateChangeHandler</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">cache</span><span class="p">[</span><span class="nx">settings</span><span class="p">.</span><span class="nx">url</span><span class="p">]);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30">&#182;</a>
</div>
<p>No, is normal request to server.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">xhr</span> <span class="o">=</span> <span class="nx">createXhr</span><span class="p">();</span>
                <span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="nx">stateChangeHandler</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">);</span>

                <span class="k">try</span> <span class="p">{</span>
                    <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">async</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">open_exception</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">errorHandlerWithAbort</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">);</span>

                    <span class="k">return</span> <span class="nx">xhr</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="nx">addHeadersToXhr</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">);</span>
                <span class="nx">addTimeoutServiceToXhr</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">);</span>

                <span class="k">try</span> <span class="p">{</span>
                    <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">params</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">send_exception</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">errorHandlerWithAbort</span><span class="p">(</span><span class="nx">settings</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">);</span>

                    <span class="k">return</span> <span class="nx">xhr</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="nx">xhr</span><span class="p">;</span>
        <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31">&#182;</a>
</div>
<p>Stop request setting in param.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">stop</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">xhr</span><span class="p">.</span><span class="nx">abort</span><span class="p">();</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32">&#182;</a>
</div>
<p>Clear memory.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">xhr</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="array.">
  <h2>
    <a href="#array." name="array." class="pilcrow">&#182;</a>
    Array.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34">&#182;</a>
</div>
<p>Check if param is array.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">isArray</span><span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">array</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">array</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;[object Array]&#39;</span> <span class="o">&amp;&amp;</span>
            <span class="k">typeof</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">array</span><span class="p">.</span><span class="nx">slice</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-35" id="section-35">&#182;</a>
</div>
<p>Check if element is in array by loop.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">inArray</span><span class="p">(</span><span class="nx">param</span><span class="p">,</span> <span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">param</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-36" id="section-36">&#182;</a>
</div>
<p>Get index of element. If couldn't find searching element, return null value.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">arrayIndex</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37">&#182;</a>
</div>
<p>Unique array. Delete element what was duplicated.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">unique</span><span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">item</span><span class="p">,</span> <span class="nx">temp</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">item</span> <span class="o">=</span> <span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inArray</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">item</span><span class="p">,</span> <span class="nx">temp</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">temp</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">temp</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-38" id="section-38">&#182;</a>
</div>
<p>Remove element declared in infinity params without first.
First parameter is array object.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">arrayRemove</span><span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">param</span><span class="p">,</span> <span class="nx">params</span> <span class="o">=</span> <span class="nx">ArrayProto</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">param</span> <span class="o">=</span> <span class="nx">params</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">inArray</span><span class="p">(</span><span class="nx">param</span><span class="p">,</span> <span class="nx">array</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">array</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">arrayIndex</span><span class="p">(</span><span class="nx">param</span><span class="p">,</span> <span class="nx">array</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">array</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">array</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">isArray</span><span class="o">:</span> <span class="nx">isArray</span><span class="p">,</span>
        <span class="nx">inArray</span><span class="o">:</span> <span class="nx">inArray</span><span class="p">,</span>
        <span class="nx">index</span><span class="o">:</span> <span class="nx">arrayIndex</span><span class="p">,</span>
        <span class="nx">unique</span><span class="o">:</span> <span class="nx">unique</span><span class="p">,</span>
        <span class="nx">remove</span><span class="o">:</span> <span class="nx">arrayRemove</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="aspect.">
  <h2>
    <a href="#aspect." name="aspect." class="pilcrow">&#182;</a>
    Aspect.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-40" id="section-40">&#182;</a>
</div>
<p>Bind function to aspect. Create method with merge first and second. Second method is run after first.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">pklib</span><span class="p">.</span><span class="nx">aspect</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">fun</span><span class="p">,</span> <span class="nx">asp</span><span class="p">,</span> <span class="nx">when</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span> <span class="nx">result</span><span class="p">;</span>

        <span class="nx">assert</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">fun</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">,</span> <span class="s1">&#39;pklib.aspect: @func: not {Function}&#39;</span><span class="p">);</span>
        <span class="nx">assert</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">asp</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">,</span> <span class="s1">&#39;pklib.aspect: @asp: not {Function}&#39;</span><span class="p">);</span>

        <span class="nx">when</span> <span class="o">=</span> <span class="nx">when</span> <span class="o">||</span> <span class="s1">&#39;before&#39;</span><span class="p">;</span>

        <span class="k">return</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">when</span> <span class="o">===</span> <span class="s1">&#39;before&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">asp</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">self</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">result</span> <span class="o">=</span> <span class="nx">fun</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">self</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">when</span> <span class="o">===</span> <span class="s1">&#39;after&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">result</span> <span class="o">=</span> <span class="nx">asp</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">self</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
        <span class="p">};</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="common.">
  <h2>
    <a href="#common." name="common." class="pilcrow">&#182;</a>
    Common.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-42" id="section-42">&#182;</a>
</div>
<p>Deferred function about some milliseconds.
If milliseconds is 0 that it's hack for some platforms to use function in 'next' thread.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">defer</span><span class="p">(</span><span class="nx">deferFn</span><span class="p">,</span> <span class="nx">milliseconds</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">milliseconds</span> <span class="o">=</span> <span class="nx">milliseconds</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">deferFn</span><span class="p">,</span> <span class="nx">milliseconds</span><span class="p">);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-43" id="section-43">&#182;</a>
</div>
<p>Interval checking first function until returns true, run after this second function callback.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">checking</span><span class="p">(</span><span class="nx">condition</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">interval</span><span class="p">,</span> <span class="nx">intervalTime</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>

        <span class="nx">assert</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">condition</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">,</span> <span class="s1">&#39;pklib.common.checking: @condition: not {Function}&#39;</span><span class="p">);</span>
        <span class="nx">assert</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">callback</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">,</span> <span class="s1">&#39;pklib.common.checking: @callback: not {Function}&#39;</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">condition</span><span class="p">())</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">interval</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">condition</span><span class="p">())</span> <span class="p">{</span>
                    <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">interval</span><span class="p">);</span>
                    <span class="nx">callback</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">},</span> <span class="nx">intervalTime</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">common</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">assert</span><span class="o">:</span> <span class="nx">assert</span><span class="p">,</span>
        <span class="nx">defer</span><span class="o">:</span> <span class="nx">defer</span><span class="p">,</span>
        <span class="nx">checking</span><span class="o">:</span> <span class="nx">checking</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="cookie.">
  <h2>
    <a href="#cookie." name="cookie." class="pilcrow">&#182;</a>
    Cookie.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-45" id="section-45">&#182;</a>
</div>
<p>Read cookie by it name.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getCookie</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">name</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">name</span> <span class="o">+=</span> <span class="s1">&#39;=&#39;</span><span class="p">;</span>

        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">ca</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">),</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">ca</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">c</span> <span class="o">=</span> <span class="nx">ca</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">c</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-46" id="section-46">&#182;</a>
</div>
<p>Create cookie file with name, value and day expired.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">createCookie</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">days</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">expires</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>

        <span class="nx">value</span> <span class="o">=</span> <span class="nx">value</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">days</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">date</span><span class="p">.</span><span class="nx">setTime</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">days</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">));</span>
            <span class="nx">expires</span> <span class="o">=</span> <span class="s1">&#39;; expires=&#39;</span> <span class="o">+</span> <span class="nx">date</span><span class="p">.</span><span class="nx">toUTCString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">=</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;=&#39;</span> <span class="o">+</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">+</span> <span class="nx">expires</span> <span class="o">+</span> <span class="s1">&#39;; path=/&#39;</span><span class="p">;</span>

        <span class="k">return</span> <span class="nx">getCookie</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-47" id="section-47">&#182;</a>
</div>
<p>Delete cookie by it name.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">removeCookie</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">createCookie</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">create</span><span class="o">:</span> <span class="nx">createCookie</span><span class="p">,</span>
        <span class="nx">get</span><span class="o">:</span> <span class="nx">getCookie</span><span class="p">,</span>
        <span class="nx">remove</span><span class="o">:</span> <span class="nx">removeCookie</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="css.">
  <h2>
    <a href="#css." name="css." class="pilcrow">&#182;</a>
    CSS.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-49" id="section-49">&#182;</a>
</div>
<p>RegExp use to delete white chars.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">rclass</span> <span class="o">=</span> <span class="sr">/[\n\t\r]/g</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-50" id="section-50">&#182;</a>
</div>
<p>Check typeof params.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">checkParams</span><span class="p">(</span><span class="nx">css_class</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">call_func_name</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">prefix</span> <span class="o">=</span> <span class="s1">&#39;pklib.css.&#39;</span> <span class="o">+</span> <span class="nx">call_func_name</span><span class="p">;</span>
        <span class="nx">assert</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">css_class</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nx">prefix</span> <span class="o">+</span> <span class="s1">&#39;: @css_class: not {string}&#39;</span><span class="p">);</span>
        <span class="nx">assert</span><span class="p">(</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">element</span><span class="p">),</span> <span class="nx">prefix</span> <span class="o">+</span> <span class="s1">&#39;: @element: not {HTMLElement}&#39;</span><span class="p">);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-51" id="section-51">&#182;</a>
</div>
<p>Check if element has CSS class.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">hasClass</span><span class="p">(</span><span class="nx">css_class</span><span class="p">,</span> <span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">checkParams</span><span class="p">(</span><span class="nx">css_class</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="s1">&#39;hasClass&#39;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">className</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">css_class</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="p">;</span>
        <span class="k">return</span> <span class="p">((</span><span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">element</span><span class="p">.</span><span class="nx">className</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">rclass</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">).</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">className</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-52" id="section-52">&#182;</a>
</div>
<p>Add CSS class to element define in second parameter.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">addClass</span><span class="p">(</span><span class="nx">css_class</span><span class="p">,</span> <span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">checkParams</span><span class="p">(</span><span class="nx">css_class</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="s1">&#39;addClass&#39;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">class_element</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">className</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">hasClass</span><span class="p">(</span><span class="nx">css_class</span><span class="p">,</span> <span class="nx">element</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">class_element</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">class_element</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">css_class</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">class_element</span> <span class="o">=</span> <span class="nx">css_class</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="nx">element</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="nx">class_element</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-53" id="section-53">&#182;</a>
</div>
<p>Remove CSS class from element define in second parameter.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">removeClass</span><span class="p">(</span><span class="nx">css_class</span><span class="p">,</span> <span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">checkParams</span><span class="p">(</span><span class="nx">css_class</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="s1">&#39;removeClass&#39;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">regexp</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s1">&#39;(\\s&#39;</span> <span class="o">+</span> <span class="nx">css_class</span> <span class="o">+</span> <span class="s1">&#39;)|(&#39;</span> <span class="o">+</span> <span class="nx">css_class</span> <span class="o">+</span> <span class="s1">&#39;\\s)|&#39;</span> <span class="o">+</span> <span class="nx">css_class</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">);</span>
        <span class="nx">element</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="nx">trim</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">regexp</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">css</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">add_class</span><span class="o">:</span> <span class="nx">addClass</span><span class="p">,</span>
        <span class="nx">remove_class</span><span class="o">:</span> <span class="nx">removeClass</span><span class="p">,</span>
        <span class="nx">has_class</span><span class="o">:</span> <span class="nx">hasClass</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="dom.">
  <h2>
    <a href="#dom." name="dom." class="pilcrow">&#182;</a>
    DOM.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-55" id="section-55">&#182;</a>
</div>
<p>Types of all available node.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">node_types</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;ELEMENT_NODE&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;ATTRIBUTE_NODE&#39;</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;TEXT_NODE&#39;</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s1">&#39;CDATA_SECTION_NODE&#39;</span><span class="o">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s1">&#39;ENTITY_REFERENCE_NODE&#39;</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="s1">&#39;ENTITY_NODE&#39;</span><span class="o">:</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s1">&#39;PROCESSING_INSTRUCTION_NODE&#39;</span><span class="o">:</span> <span class="mi">7</span><span class="p">,</span>
        <span class="s1">&#39;COMMENT_NODE&#39;</span><span class="o">:</span> <span class="mi">8</span><span class="p">,</span>
        <span class="s1">&#39;DOCUMENT_NODE&#39;</span><span class="o">:</span> <span class="mi">9</span><span class="p">,</span>
        <span class="s1">&#39;DOCUMENT_TYPE_NODE&#39;</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="s1">&#39;DOCUMENT_FRAGMENT_NODE&#39;</span><span class="o">:</span> <span class="mi">11</span><span class="p">,</span>
        <span class="s1">&#39;NOTATION_NODE&#39;</span><span class="o">:</span> <span class="mi">12</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-56" id="section-56">&#182;</a>
</div>
<p>Walking on every node in node.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">walkTheDom</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">func</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!!</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">func</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
            <span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">walkTheDom</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">func</span><span class="p">);</span>
                <span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-57" id="section-57">&#182;</a>
</div>
<p>Check if param is Node, with use assertions.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">isNode</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">node</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">&amp;&amp;</span>
            <span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;[object Node]&#39;</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-58" id="section-58">&#182;</a>
</div>
<p>Check if param is NodeList, with use assertions.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">isNodeList</span><span class="p">(</span><span class="nx">node_list</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;[object HTMLCollection]&#39;</span><span class="p">,</span> <span class="s1">&#39;[object NodeList]&#39;</span><span class="p">];</span>
        <span class="k">return</span> <span class="nx">inArray</span><span class="p">(</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">node_list</span><span class="p">),</span> <span class="nx">list</span><span class="p">);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-59" id="section-59">&#182;</a>
</div>
<p>Check if param is instanceOf Element.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">isElement</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">node</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="nx">node_types</span><span class="p">.</span><span class="nx">ELEMENT_NODE</span><span class="p">)</span> <span class="o">||</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-60" id="section-60">&#182;</a>
</div>
<p>Check visibility of Node, with use assertions.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">isVisible</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">assert</span><span class="p">(</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">node</span><span class="p">),</span> <span class="s1">&#39;pklib.dom.isVisible: @node is not HTMLElement&#39;</span><span class="p">);</span>

        <span class="k">return</span> <span class="nx">node</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">!==</span> <span class="s1">&#39;none&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">visibility</span> <span class="o">!==</span> <span class="s1">&#39;hidden&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="p">.</span><span class="nx">offsetWidth</span> <span class="o">!==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="p">.</span><span class="nx">offsetHeight</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-61" id="section-61">&#182;</a>
</div>
<p>Get element by attribute ID.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">byId</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-62" id="section-62">&#182;</a>
</div>
<p>Get elements by tag name.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">byTag</span><span class="p">(</span><span class="nx">tag</span><span class="p">,</span> <span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">element</span> <span class="o">||</span> <span class="nb">document</span><span class="p">).</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">tag</span><span class="p">);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-63" id="section-63">&#182;</a>
</div>
<p>Get elements by attribute CLASS.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">byClass</span><span class="p">(</span><span class="nx">css_class</span><span class="p">,</span> <span class="nx">wrapper</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>

        <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">wrapper</span> <span class="o">||</span> <span class="nb">document</span><span class="p">;</span>

        <span class="nx">walkTheDom</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">hasClass</span><span class="p">(</span><span class="nx">css_class</span><span class="p">,</span> <span class="nx">node</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">});</span>
        <span class="k">return</span> <span class="nx">results</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-64" id="section-64">&#182;</a>
</div>
<p>Get index of node relative siblings.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">nodeIndex</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">assert</span><span class="p">(</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">node</span><span class="p">),</span> <span class="s1">&#39;pklib.dom.index: @node is not HTMLElement&#39;</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">childrenInstance</span> <span class="o">=</span> <span class="nx">children</span><span class="p">(</span><span class="nx">parent</span><span class="p">(</span><span class="nx">node</span><span class="p">)),</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">children</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">childrenInstance</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-65" id="section-65">&#182;</a>
</div>
<p>Get children of element filter by Element type.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">children</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">assert</span><span class="p">(</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">node</span><span class="p">),</span> <span class="s1">&#39;pklib.dom.children: @node is not HTMLElement&#39;</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">array</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">childNodes</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">childNodes</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>
                <span class="nx">array</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">childNodes</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">array</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-66" id="section-66">&#182;</a>
</div>
<p>Insert data to Node. Maybe param is string so insert will be exec
by innerHTML, but if param is Node inserting with appendChild().</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">insert</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">element</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">node</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">isString</span><span class="p">(</span><span class="nx">element</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">node</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">+=</span> <span class="nx">element</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">element</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-67" id="section-67">&#182;</a>
</div>
<p>Remove Element specified in params.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">nodeRemove</span><span class="p">(</span><span class="nx">items</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">node</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">parent</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">ArrayProto</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">),</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">node</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">node</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">parent</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>
                <span class="nx">parent</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-68" id="section-68">&#182;</a>
</div>
<p>Get prev Node what will be Element.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">prev</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">prev_node</span><span class="p">;</span>

        <span class="nx">assert</span><span class="p">(</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">node</span><span class="p">),</span> <span class="s1">&#39;pklib.dom.prev: @node is not HTMLElement&#39;</span><span class="p">);</span>

        <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">prev_node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">previousSibling</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">prev_node</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">&amp;&amp;</span> <span class="nx">prev_node</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">prev_node</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">!==</span> <span class="nx">node_types</span><span class="p">.</span><span class="nx">ELEMENT_NODE</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">node</span> <span class="o">=</span> <span class="nx">prev_node</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">prev_node</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-69" id="section-69">&#182;</a>
</div>
<p>Get next Node what will be Element.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">next</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">next_node</span><span class="p">;</span>

        <span class="nx">assert</span><span class="p">(</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">node</span><span class="p">),</span> <span class="s1">&#39;pklib.dom.next: @node is not HTMLElement&#39;</span><span class="p">);</span>

        <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">next_node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">next_node</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">&amp;&amp;</span> <span class="nx">next_node</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">next_node</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">!==</span> <span class="nx">node_types</span><span class="p">.</span><span class="nx">ELEMENT_NODE</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">node</span> <span class="o">=</span> <span class="nx">next_node</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">next_node</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-70" id="section-70">&#182;</a>
</div>
<p>Get parent element what will by Element, but if parent is not exists returns null.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">parent</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">parent_node</span><span class="p">;</span>

        <span class="nx">assert</span><span class="p">(</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">node</span><span class="p">),</span> <span class="s1">&#39;pklib.dom.parent: @node is not HTMLElement&#39;</span><span class="p">);</span>

        <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">parent_node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">parent_node</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">&amp;&amp;</span> <span class="nx">parent_node</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">parent_node</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">!==</span> <span class="nx">node_types</span><span class="p">.</span><span class="nx">ELEMENT_NODE</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">node</span> <span class="o">=</span> <span class="nx">parent_node</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">parent_node</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">dom</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">isNode</span><span class="o">:</span> <span class="nx">isNode</span><span class="p">,</span>
        <span class="nx">isNodeList</span><span class="o">:</span> <span class="nx">isNodeList</span><span class="p">,</span>
        <span class="nx">isElement</span><span class="o">:</span> <span class="nx">isElement</span><span class="p">,</span>
        <span class="nx">isVisible</span><span class="o">:</span> <span class="nx">isVisible</span><span class="p">,</span>
        <span class="nx">byId</span><span class="o">:</span> <span class="nx">byId</span><span class="p">,</span>
        <span class="nx">byTag</span><span class="o">:</span> <span class="nx">byTag</span><span class="p">,</span>
        <span class="nx">byClass</span><span class="o">:</span> <span class="nx">byClass</span><span class="p">,</span>
        <span class="nx">index</span><span class="o">:</span> <span class="nx">nodeIndex</span><span class="p">,</span>
        <span class="nx">children</span><span class="o">:</span> <span class="nx">children</span><span class="p">,</span>
        <span class="nx">insert</span><span class="o">:</span> <span class="nx">insert</span><span class="p">,</span>
        <span class="nx">remove</span><span class="o">:</span> <span class="nx">nodeRemove</span><span class="p">,</span>
        <span class="nx">prev</span><span class="o">:</span> <span class="nx">prev</span><span class="p">,</span>
        <span class="nx">next</span><span class="o">:</span> <span class="nx">next</span><span class="p">,</span>
        <span class="nx">parent</span><span class="o">:</span> <span class="nx">parent</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="events.">
  <h2>
    <a href="#events." name="events." class="pilcrow">&#182;</a>
    Events.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-72" id="section-72">&#182;</a>
</div>
<p>Add event to Element.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">addEvent</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">event_name</span><span class="p">,</span> <span class="nx">handler</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">events</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">target</span><span class="p">.</span><span class="nx">events</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">event</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">events</span><span class="p">[</span><span class="nx">event_name</span><span class="p">];</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">event</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">target</span><span class="p">.</span><span class="nx">events</span><span class="p">[</span><span class="nx">event_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="p">}</span>

        <span class="nx">target</span><span class="p">.</span><span class="nx">events</span><span class="p">[</span><span class="nx">event_name</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">handler</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-73" id="section-73">&#182;</a>
</div>
<p>IE browser.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">target</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s1">&#39;on&#39;</span> <span class="o">+</span> <span class="nx">event_name</span><span class="p">,</span> <span class="nx">handler</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-74" id="section-74">&#182;</a>
</div>
<p>Other browser.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">target</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">event_name</span><span class="p">,</span> <span class="nx">handler</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-75" id="section-75">&#182;</a>
</div>
<p>For very old browser.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">target</span><span class="p">[</span><span class="s1">&#39;on&#39;</span> <span class="o">+</span> <span class="nx">event_name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">handler</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-76" id="section-76">&#182;</a>
</div>
<p>Remove event from Element.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">removeEvent</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">event_name</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">removeAPI</span><span class="p">,</span> <span class="nx">events</span><span class="p">,</span> <span class="nx">len</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">handler</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">events</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">target</span><span class="p">.</span><span class="nx">events</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">detachEvent</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-77" id="section-77">&#182;</a>
</div>
<p>IE browser.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">removeAPI</span> <span class="o">=</span> <span class="s1">&#39;detachEvent&#39;</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-78" id="section-78">&#182;</a>
</div>
<p>Other browser</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">removeAPI</span> <span class="o">=</span> <span class="s1">&#39;removeEventListener&#39;</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">removeAPI</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-79" id="section-79">&#182;</a>
</div>
<p>For old browser.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">delete</span> <span class="nx">target</span><span class="p">[</span><span class="s1">&#39;on&#39;</span> <span class="o">+</span> <span class="nx">event_name</span><span class="p">];</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">events</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">events</span><span class="p">[</span><span class="nx">event_name</span><span class="p">];</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">events</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">len</span> <span class="o">=</span> <span class="nx">events</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

                <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">handler</span> <span class="o">=</span> <span class="nx">events</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                    <span class="nx">target</span><span class="p">[</span><span class="nx">removeAPI</span><span class="p">](</span><span class="nx">event_name</span><span class="p">,</span> <span class="nx">handler</span><span class="p">);</span>
                    <span class="k">delete</span> <span class="nx">target</span><span class="p">.</span><span class="nx">events</span><span class="p">[</span><span class="nx">event_name</span><span class="p">];</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-80" id="section-80">&#182;</a>
</div>
<p>Get array with events with concrete name.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getEvent</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">event_name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">events</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">target</span><span class="p">.</span><span class="nx">events</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">target</span><span class="p">.</span><span class="nx">events</span><span class="p">[</span><span class="nx">event_name</span><span class="p">];</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-81" id="section-81">&#182;</a>
</div>
<p>Run events on Element.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">trigger</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">event_name</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">events</span><span class="p">,</span> <span class="nx">len</span><span class="p">,</span> <span class="nx">i</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">events</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">target</span><span class="p">.</span><span class="nx">events</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="p">}</span>

        <span class="nx">events</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">events</span><span class="p">[</span><span class="nx">event_name</span><span class="p">];</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">events</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">len</span> <span class="o">=</span> <span class="nx">events</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">events</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">call</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">events</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">add</span><span class="o">:</span> <span class="nx">addEvent</span><span class="p">,</span>
        <span class="nx">remove</span><span class="o">:</span> <span class="nx">removeEvent</span><span class="p">,</span>
        <span class="nx">get</span><span class="o">:</span> <span class="nx">getEvent</span><span class="p">,</span>
        <span class="nx">trigger</span><span class="o">:</span> <span class="nx">trigger</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="file.">
  <h2>
    <a href="#file." name="file." class="pilcrow">&#182;</a>
    File.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>

    <span class="kd">var</span> <span class="nx">copy_files</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="kd">function</span> <span class="nx">simpleLoadJS</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">script</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>
        <span class="nx">script</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;text/javascript&#39;</span><span class="p">;</span>
        <span class="nx">script</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">url</span><span class="p">;</span>

        <span class="kd">function</span> <span class="nx">success_callback</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">callback</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">callback</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kd">function</span> <span class="nx">readystatechange</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">script</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="s1">&#39;loaded&#39;</span> <span class="o">||</span> <span class="nx">script</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="s1">&#39;complete&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">script</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                <span class="nx">success_callback</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">script</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">script</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="nx">success_callback</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">script</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="nx">readystatechange</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">head</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">document</span><span class="p">.</span><span class="nx">head</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;head&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="nb">document</span><span class="p">.</span><span class="nx">head</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-83" id="section-83">&#182;</a>
</div>
<p>Load JS files. Url to files could be with path absolute or not.
If you must load more than 1 file use array, to set url to files.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">loadJSFile</span><span class="p">(</span><span class="nx">files</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">file</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">files</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">file</span> <span class="o">=</span> <span class="nx">files</span><span class="p">;</span>
            <span class="nx">simpleLoadJS</span><span class="p">(</span><span class="nx">file</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">script</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">callback</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">callback</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">files</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">copy_files</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">copy_files</span> <span class="o">=</span> <span class="nx">mixin</span><span class="p">(</span><span class="nx">copy_files</span><span class="p">,</span> <span class="nx">files</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">file</span> <span class="o">=</span> <span class="nx">files</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">file</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">callback</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">callback</span><span class="p">({</span>
                        <span class="nx">src</span><span class="o">:</span> <span class="nx">copy_files</span><span class="p">[</span><span class="nx">copy_files</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="p">});</span>

                    <span class="nx">copy_files</span> <span class="o">=</span> <span class="p">[];</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">simpleLoadJS</span><span class="p">(</span><span class="nx">file</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                    <span class="nx">loadJSFile</span><span class="p">(</span><span class="nx">files</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
                <span class="p">});</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;pklib.file.loadjs: @files not {string} or {Array}&#39;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">file</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">loadjs</span><span class="o">:</span> <span class="nx">loadJSFile</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="object.">
  <h2>
    <a href="#object." name="object." class="pilcrow">&#182;</a>
    Object.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-85" id="section-85">&#182;</a>
</div>
<p>Check if param is object.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">isObject</span><span class="p">(</span><span class="nx">it</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">it</span> <span class="o">&amp;&amp;</span> <span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">it</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;[object Object]&#39;</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">it</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span> <span class="o">&amp;&amp;</span>
            <span class="k">typeof</span> <span class="nx">it</span><span class="p">.</span><span class="nx">hasOwnProperty</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">it</span><span class="p">.</span><span class="nx">isPrototypeOf</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-86" id="section-86">&#182;</a>
</div>
<p>Mix two params, from second to first param. Return first param mixin with second param.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">mixin</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">len</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">item</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">isArray</span><span class="p">(</span><span class="nx">source</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">len</span> <span class="o">=</span> <span class="nx">source</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">element</span> <span class="o">=</span> <span class="nx">source</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inArray</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">target</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nx">target</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">item</span> <span class="k">in</span> <span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">source</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">item</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">target</span><span class="p">[</span><span class="nx">item</span><span class="p">]))</span> <span class="p">{</span>
                        <span class="nx">target</span><span class="p">[</span><span class="nx">item</span><span class="p">]</span> <span class="o">=</span> <span class="nx">mixin</span><span class="p">(</span><span class="nx">target</span><span class="p">[</span><span class="nx">item</span><span class="p">],</span> <span class="nx">source</span><span class="p">[</span><span class="nx">item</span><span class="p">]);</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="nx">target</span><span class="p">[</span><span class="nx">item</span><span class="p">]</span> <span class="o">=</span> <span class="nx">source</span><span class="p">[</span><span class="nx">item</span><span class="p">];</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">target</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-87" id="section-87">&#182;</a>
</div>
<p>Check if object is empty (contains non-value).</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">isEmpty</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">object</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">isObject</span><span class="o">:</span> <span class="nx">isObject</span><span class="p">,</span>
        <span class="nx">mixin</span><span class="o">:</span> <span class="nx">mixin</span><span class="p">,</span>
        <span class="nx">isEmpty</span><span class="o">:</span> <span class="nx">isEmpty</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="profiler.">
  <h2>
    <a href="#profiler." name="profiler." class="pilcrow">&#182;</a>
    Profiler.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>

    <span class="kd">var</span> <span class="nx">profilerData</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="kd">function</span> <span class="nx">startProfile</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">profilerData</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
        <span class="k">return</span> <span class="nx">profilerData</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">stopProfile</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">profilerData</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span> <span class="o">-</span> <span class="nx">profilerData</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
        <span class="k">return</span> <span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">((</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()).</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">+</span> <span class="nx">profilerData</span><span class="p">[</span><span class="nx">name</span><span class="p">])).</span><span class="nx">getTime</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">getProfilerTime</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">profilerData</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">profiler</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">start</span><span class="o">:</span> <span class="nx">startProfile</span><span class="p">,</span>
        <span class="nx">stop</span><span class="o">:</span> <span class="nx">stopProfile</span><span class="p">,</span>
        <span class="nx">getTime</span><span class="o">:</span> <span class="nx">getProfilerTime</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="string.">
  <h2>
    <a href="#string." name="string." class="pilcrow">&#182;</a>
    String.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>

    <span class="kd">function</span> <span class="nx">isString</span><span class="p">(</span><span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">typeof</span> <span class="nx">source</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">isLetter</span><span class="p">(</span><span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">isString</span><span class="p">(</span><span class="nx">source</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="sr">/^[a-zA-Z]$/</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">source</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">trim</span><span class="p">(</span><span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">source</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\s+|\s+$/g</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">slug</span><span class="p">(</span><span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">polish</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="nx">polish</span><span class="p">[</span><span class="mi">261</span><span class="p">]</span> <span class="o">=</span> <span class="mi">97</span><span class="p">;</span>
        <span class="nx">polish</span><span class="p">[</span><span class="mi">281</span><span class="p">]</span> <span class="o">=</span> <span class="mi">101</span><span class="p">;</span>
        <span class="nx">polish</span><span class="p">[</span><span class="mi">243</span><span class="p">]</span> <span class="o">=</span> <span class="mi">111</span><span class="p">;</span>
        <span class="nx">polish</span><span class="p">[</span><span class="mi">347</span><span class="p">]</span> <span class="o">=</span> <span class="mi">115</span><span class="p">;</span>
        <span class="nx">polish</span><span class="p">[</span><span class="mi">322</span><span class="p">]</span> <span class="o">=</span> <span class="mi">108</span><span class="p">;</span>
        <span class="nx">polish</span><span class="p">[</span><span class="mi">378</span><span class="p">]</span> <span class="o">=</span> <span class="nx">polish</span><span class="p">[</span><span class="mi">380</span><span class="p">]</span> <span class="o">=</span> <span class="mi">122</span><span class="p">;</span>
        <span class="nx">polish</span><span class="p">[</span><span class="mi">263</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span><span class="p">;</span>
        <span class="nx">polish</span><span class="p">[</span><span class="mi">324</span><span class="p">]</span> <span class="o">=</span> <span class="mi">110</span><span class="p">;</span>

        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">source</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\s/mg</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
        <span class="nx">result</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[^a-zA-Z0-9\-]/mg</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">ch</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="kr">char</span> <span class="o">=</span> <span class="nx">polish</span><span class="p">[</span><span class="nx">ch</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)];</span>
            <span class="k">if</span> <span class="p">(</span><span class="kr">char</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="kr">char</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="p">});</span>
        <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">capitalize</span><span class="p">(</span><span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">source</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="o">+</span> <span class="nx">source</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">source</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">delimiterSeparatedWords</span><span class="p">(</span><span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">source</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[A-Z]/g</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">match</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nx">match</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">stripTags</span><span class="p">(</span><span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">assert</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">source</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;pklib.string.stripTags: param @source is not a string&#39;</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">source</span> <span class="o">&amp;&amp;</span> <span class="nx">source</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">dummy</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
            <span class="nx">dummy</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">source</span><span class="p">;</span>
            <span class="k">return</span> <span class="nx">dummy</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">||</span> <span class="nx">dummy</span><span class="p">.</span><span class="nx">innerText</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">source</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">camelCase</span><span class="p">(</span><span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">pos</span><span class="p">,</span> <span class="nx">pre</span><span class="p">,</span> <span class="nx">sub</span><span class="p">,</span> <span class="nx">post</span><span class="p">;</span>

        <span class="k">while</span> <span class="p">(</span><span class="nx">source</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">pos</span> <span class="o">=</span> <span class="nx">source</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">);</span>
            <span class="nx">pre</span> <span class="o">=</span> <span class="nx">source</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">pos</span><span class="p">);</span>
            <span class="nx">sub</span> <span class="o">=</span> <span class="nx">source</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">();</span>
            <span class="nx">post</span> <span class="o">=</span> <span class="nx">source</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">pos</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">source</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
            <span class="nx">source</span> <span class="o">=</span> <span class="nx">pre</span> <span class="o">+</span> <span class="nx">sub</span> <span class="o">+</span> <span class="nx">post</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">source</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">slice</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="nx">length</span><span class="p">,</span> <span class="nx">is_force</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">assert</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">source</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;pklib.string.slice: param @source is not a string&#39;</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-90" id="section-90">&#182;</a>
</div>
<p>When source is longer than limit, return it</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="nx">source</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">source</span><span class="p">;</span>
        <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-91" id="section-91">&#182;</a>
</div>
<p>Slice source text using second param</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">source</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">length</span><span class="p">),</span> <span class="nx">last_space</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-92" id="section-92">&#182;</a>
</div>
<p>If we don't cut in the middle of word, add ellipsis</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="nx">source</span><span class="p">[</span><span class="nx">length</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39; &#39;</span> <span class="o">||</span> <span class="nx">text</span><span class="p">[</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">trim</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;...&#39;</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_force</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">last_space</span> <span class="o">=</span> <span class="nx">text</span><span class="p">.</span><span class="nx">lastIndexOf</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">last_space</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">text</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">last_space</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;...&#39;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">text</span> <span class="o">+</span> <span class="s1">&#39;...&#39;</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-93" id="section-93">&#182;</a>
</div>
<p>Replace tags in string to defined data.
${NAME} - replace by value of object['NAME']</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">format</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">name</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">name</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">str</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s1">&#39;%{&#39;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">,</span> <span class="s1">&#39;ig&#39;</span><span class="p">),</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">name</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-94" id="section-94">&#182;</a>
</div>
<p>Left padding any chars.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">lpad</span><span class="p">(</span><span class="nx">staff</span><span class="p">,</span> <span class="nx">nrFill</span><span class="p">,</span> <span class="nx">add_char</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">string</span> <span class="o">=</span> <span class="nx">staff</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">string</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">nrFill</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">string</span> <span class="o">=</span> <span class="nx">add_char</span> <span class="o">+</span> <span class="nx">string</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">string</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-95" id="section-95">&#182;</a>
</div>
<p>Right padding any chars.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">rpad</span><span class="p">(</span><span class="nx">staff</span><span class="p">,</span> <span class="nx">nrFill</span><span class="p">,</span> <span class="nx">add_char</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">string</span> <span class="o">=</span> <span class="nx">staff</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">string</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">nrFill</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">string</span> <span class="o">+=</span> <span class="nx">add_char</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">string</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">string</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">isString</span><span class="o">:</span> <span class="nx">isString</span><span class="p">,</span>
        <span class="nx">isLetter</span><span class="o">:</span> <span class="nx">isLetter</span><span class="p">,</span>
        <span class="nx">trim</span><span class="o">:</span> <span class="nx">trim</span><span class="p">,</span>
        <span class="nx">slug</span><span class="o">:</span> <span class="nx">slug</span><span class="p">,</span>
        <span class="nx">capitalize</span><span class="o">:</span> <span class="nx">capitalize</span><span class="p">,</span>
        <span class="nx">delimiterSeparatedWords</span><span class="o">:</span> <span class="nx">delimiterSeparatedWords</span><span class="p">,</span>
        <span class="nx">stripTags</span><span class="o">:</span> <span class="nx">stripTags</span><span class="p">,</span>
        <span class="nx">camelCase</span><span class="o">:</span> <span class="nx">camelCase</span><span class="p">,</span>
        <span class="nx">slice</span><span class="o">:</span> <span class="nx">slice</span><span class="p">,</span>
        <span class="nx">format</span><span class="o">:</span> <span class="nx">format</span><span class="p">,</span>
        <span class="nx">lpad</span><span class="o">:</span> <span class="nx">lpad</span><span class="p">,</span>
        <span class="nx">rpad</span><span class="o">:</span> <span class="nx">rpad</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="ui">
  <h2>
    <a href="#ui" name="ui" class="pilcrow">&#182;</a>
    UI
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>

    <span class="kd">function</span> <span class="nx">center</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">wrapper</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">left</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">top</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">pus</span> <span class="o">=</span> <span class="nx">pklib</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">size</span><span class="p">;</span>

        <span class="nx">assert</span><span class="p">(</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">element</span><span class="p">),</span> <span class="s1">&#39;pklib.ui.center: @element: not {HTMLElement}&#39;</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">wrapper</span> <span class="o">===</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">left</span> <span class="o">=</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">pus</span><span class="p">.</span><span class="nb">window</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">),</span> <span class="nx">pus</span><span class="p">.</span><span class="nb">document</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">))</span> <span class="o">-</span> <span class="nx">pus</span><span class="p">.</span><span class="nx">object</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
            <span class="nx">top</span> <span class="o">=</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">pus</span><span class="p">.</span><span class="nb">window</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">),</span> <span class="nx">pus</span><span class="p">.</span><span class="nb">document</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">))</span> <span class="o">-</span> <span class="nx">pus</span><span class="p">.</span><span class="nx">object</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">left</span> <span class="o">=</span> <span class="p">(</span><span class="nx">pus</span><span class="p">.</span><span class="nb">window</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="nx">pus</span><span class="p">.</span><span class="nx">object</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
            <span class="nx">top</span> <span class="o">=</span> <span class="p">(</span><span class="nx">pus</span><span class="p">.</span><span class="nb">window</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="nx">pus</span><span class="p">.</span><span class="nx">object</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="nx">left</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
        <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="nx">top</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
        <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="s1">&#39;absolute&#39;</span><span class="p">;</span>
        <span class="k">return</span> <span class="p">[</span><span class="nx">left</span><span class="p">,</span> <span class="nx">top</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">maximize</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">wrapper</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">width</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">height</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">pus</span> <span class="o">=</span> <span class="nx">pklib</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">size</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">wrapper</span> <span class="o">===</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">width</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">pus</span><span class="p">.</span><span class="nb">window</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">),</span> <span class="nx">pus</span><span class="p">.</span><span class="nb">document</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">));</span>
            <span class="nx">height</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">pus</span><span class="p">.</span><span class="nb">window</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">),</span> <span class="nx">pus</span><span class="p">.</span><span class="nb">document</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">));</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">isIE</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">width</span> <span class="o">-=</span> <span class="mi">20</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">width</span> <span class="o">=</span> <span class="nx">pus</span><span class="p">.</span><span class="nx">object</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">);</span>
            <span class="nx">height</span> <span class="o">=</span> <span class="nx">pus</span><span class="p">.</span><span class="nx">object</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">width</span><span class="p">;</span>
        <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">height</span><span class="p">;</span>
        <span class="k">return</span> <span class="p">[</span><span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">scrollTo</span><span class="p">(</span><span class="nx">param</span><span class="p">,</span> <span class="nx">animate</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">interval</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">animate</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">interval</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">scroll_top</span> <span class="o">-=</span> <span class="mi">5</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">scroll_top</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">interval</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">},</span> <span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">scroll_top</span> <span class="o">=</span> <span class="nx">param</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">ui</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">center</span><span class="o">:</span> <span class="nx">center</span><span class="p">,</span>
        <span class="nx">maximize</span><span class="o">:</span> <span class="nx">maximize</span><span class="p">,</span>
        <span class="nx">scrollTo</span><span class="o">:</span> <span class="nx">scrollTo</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="ui%20glass.">
  <h2>
    <a href="#ui%20glass." name="ui%20glass." class="pilcrow">&#182;</a>
    UI Glass.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>

    <span class="kd">var</span> <span class="nx">glassId</span> <span class="o">=</span> <span class="s1">&#39;pklib-glass-wrapper&#39;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">glassSettings</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">container</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">style</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">position</span><span class="o">:</span> <span class="s1">&#39;absolute&#39;</span><span class="p">,</span>
            <span class="nx">left</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">top</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">background</span><span class="o">:</span> <span class="s1">&#39;#000&#39;</span><span class="p">,</span>
            <span class="nx">opacity</span><span class="o">:</span> <span class="mf">0.5</span><span class="p">,</span>
            <span class="nx">zIndex</span><span class="o">:</span> <span class="mi">1000</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="kd">function</span> <span class="nx">showGlass</span><span class="p">(</span><span class="nx">config</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">glass</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">),</span>
            <span class="nx">glassStyle</span> <span class="o">=</span> <span class="nx">glass</span><span class="p">.</span><span class="nx">style</span><span class="p">,</span>
            <span class="nx">style</span><span class="p">;</span>

        <span class="nx">glassSettings</span><span class="p">.</span><span class="nx">container</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
        <span class="nx">glassSettings</span> <span class="o">=</span> <span class="nx">mixin</span><span class="p">(</span><span class="nx">glassSettings</span><span class="p">,</span> <span class="nx">config</span><span class="p">);</span>
        <span class="nx">glassSettings</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">filter</span> <span class="o">=</span> <span class="s1">&#39;alpha(opacity=&#39;</span> <span class="o">+</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">glassSettings</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span>

        <span class="nx">glass</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nx">glassId</span><span class="p">);</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">style</span> <span class="k">in</span> <span class="nx">glassSettings</span><span class="p">.</span><span class="nx">style</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">glassSettings</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">style</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">glassStyle</span><span class="p">[</span><span class="nx">style</span><span class="p">]</span> <span class="o">=</span> <span class="nx">glassSettings</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">style</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">glassSettings</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">glass</span><span class="p">);</span>

        <span class="nx">maximize</span><span class="p">(</span><span class="nx">glass</span><span class="p">,</span> <span class="nx">glassSettings</span><span class="p">.</span><span class="nx">container</span><span class="p">);</span>

        <span class="nx">addEvent</span><span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="s1">&#39;resize&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">closeGlass</span><span class="p">();</span>
            <span class="nx">showGlass</span><span class="p">(</span><span class="nx">config</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
            <span class="nx">maximize</span><span class="p">(</span><span class="nx">glass</span><span class="p">,</span> <span class="nx">glassSettings</span><span class="p">.</span><span class="nx">container</span><span class="p">);</span>
        <span class="p">});</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">callback</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">glass</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">closeGlass</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">glass</span> <span class="o">=</span> <span class="nx">byId</span><span class="p">(</span><span class="nx">glassId</span><span class="p">),</span>
            <span class="nx">result</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

        <span class="nx">removeEvent</span><span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="s1">&#39;resize&#39;</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">glass</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">glass</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">glass</span><span class="p">);</span>
            <span class="nx">closeGlass</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
            <span class="nx">result</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">callback</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">glass</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">objId</span><span class="o">:</span> <span class="nx">glassId</span><span class="p">,</span>
        <span class="nx">show</span><span class="o">:</span> <span class="nx">showGlass</span><span class="p">,</span>
        <span class="nx">close</span><span class="o">:</span> <span class="nx">closeGlass</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="ui%20loader.">
  <h2>
    <a href="#ui%20loader." name="ui%20loader." class="pilcrow">&#182;</a>
    UI Loader.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>

    <span class="kd">var</span> <span class="nx">loaderId</span> <span class="o">=</span> <span class="s1">&#39;pklib-loader-wrapper&#39;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">loaderSettings</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">src</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="nx">container</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">style</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">width</span><span class="o">:</span> <span class="mi">31</span><span class="p">,</span>
            <span class="nx">height</span><span class="o">:</span> <span class="mi">31</span><span class="p">,</span>
            <span class="nx">zIndex</span><span class="o">:</span> <span class="mi">1010</span>
        <span class="p">},</span>
        <span class="nx">center</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">};</span>

    <span class="kd">function</span> <span class="nx">showLoader</span><span class="p">(</span><span class="nx">config</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">loader</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">),</span>
            <span class="nx">loaderStyle</span> <span class="o">=</span> <span class="nx">loader</span><span class="p">.</span><span class="nx">style</span><span class="p">,</span>
            <span class="nx">style</span><span class="p">;</span>

        <span class="nx">loaderSettings</span><span class="p">.</span><span class="nx">container</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
        <span class="nx">loaderSettings</span> <span class="o">=</span> <span class="nx">mixin</span><span class="p">(</span><span class="nx">loaderSettings</span><span class="p">,</span> <span class="nx">config</span><span class="p">);</span>

        <span class="nx">loader</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nx">pklib</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">loader</span><span class="p">.</span><span class="nx">objId</span><span class="p">);</span>
        <span class="nx">loader</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;src&#39;</span><span class="p">,</span> <span class="nx">loaderSettings</span><span class="p">.</span><span class="nx">src</span><span class="p">);</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">style</span> <span class="k">in</span> <span class="nx">loaderSettings</span><span class="p">.</span><span class="nx">style</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">loaderSettings</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">style</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">loaderStyle</span><span class="p">[</span><span class="nx">style</span><span class="p">]</span> <span class="o">=</span> <span class="nx">loaderSettings</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">style</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">center</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">center</span><span class="p">(</span><span class="nx">loader</span><span class="p">,</span> <span class="nx">loaderSettings</span><span class="p">.</span><span class="nx">container</span><span class="p">);</span>

            <span class="nx">addEvent</span><span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="s1">&#39;resize&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="nx">center</span><span class="p">(</span><span class="nx">loader</span><span class="p">,</span> <span class="nx">loaderSettings</span><span class="p">.</span><span class="nx">container</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>

        <span class="nx">loaderSettings</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">loader</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">callback</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">();</span>
        <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-99" id="section-99">&#182;</a>
</div>
<p>Clear memory.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">loader</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">closeLoader</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">loader</span> <span class="o">=</span> <span class="nx">byId</span><span class="p">(</span><span class="nx">loaderId</span><span class="p">),</span>
            <span class="nx">result</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">loader</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">loader</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">loader</span><span class="p">);</span>
            <span class="nx">closeLoader</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
            <span class="nx">result</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">callback</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">loader</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">objId</span><span class="o">:</span> <span class="nx">loaderId</span><span class="p">,</span>
        <span class="nx">show</span><span class="o">:</span> <span class="nx">showLoader</span><span class="p">,</span>
        <span class="nx">close</span><span class="o">:</span> <span class="nx">closeLoader</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="ui%20message.">
  <h2>
    <a href="#ui%20message." name="ui%20message." class="pilcrow">&#182;</a>
    UI Message.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>

    <span class="kd">var</span> <span class="nx">messageId</span> <span class="o">=</span> <span class="s1">&#39;pklib-message-wrapper&#39;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">messageSettings</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">container</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">style</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">width</span><span class="o">:</span> <span class="mi">300</span><span class="p">,</span>
            <span class="nx">height</span><span class="o">:</span> <span class="mi">300</span><span class="p">,</span>
            <span class="nx">zIndex</span><span class="o">:</span> <span class="mi">1010</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="kd">function</span> <span class="nx">showMessage</span><span class="p">(</span><span class="nx">config</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">message</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">),</span>
            <span class="nx">messageStyle</span> <span class="o">=</span> <span class="nx">message</span><span class="p">.</span><span class="nx">style</span><span class="p">,</span>
            <span class="nx">style</span><span class="p">;</span>

        <span class="nx">messageSettings</span><span class="p">.</span><span class="nx">container</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
        <span class="nx">messageSettings</span> <span class="o">=</span> <span class="nx">mixin</span><span class="p">(</span><span class="nx">messageSettings</span><span class="p">,</span> <span class="nx">config</span><span class="p">);</span>

        <span class="nx">message</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nx">pklib</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">message</span><span class="p">.</span><span class="nx">objId</span><span class="p">);</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">style</span> <span class="k">in</span> <span class="nx">messageSettings</span><span class="p">.</span><span class="nx">style</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">messageSettings</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">style</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">messageStyle</span><span class="p">[</span><span class="nx">style</span><span class="p">]</span> <span class="o">=</span> <span class="nx">messageSettings</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">style</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">insert</span><span class="p">(</span><span class="nx">pklib</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">message</span><span class="p">.</span><span class="nx">content</span><span class="p">,</span> <span class="nx">message</span><span class="p">);</span>

        <span class="nx">messageSettings</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
        <span class="nx">center</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">messageSettings</span><span class="p">.</span><span class="nx">container</span><span class="p">);</span>

        <span class="nx">addEvent</span><span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="s1">&#39;resize&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">center</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">messageSettings</span><span class="p">.</span><span class="nx">container</span><span class="p">);</span>
        <span class="p">});</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">callback</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">message</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">closeMessage</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">message</span> <span class="o">=</span> <span class="nx">byId</span><span class="p">(</span><span class="nx">pklib</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">message</span><span class="p">.</span><span class="nx">objId</span><span class="p">),</span>
            <span class="nx">result</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">message</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">message</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
            <span class="nx">closeMessage</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
            <span class="nx">result</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">callback</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">objId</span><span class="o">:</span> <span class="nx">messageId</span><span class="p">,</span>
        <span class="nx">content</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">show</span><span class="o">:</span> <span class="nx">showMessage</span><span class="p">,</span>
        <span class="nx">close</span><span class="o">:</span> <span class="nx">closeMessage</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="ui%20size.">
  <h2>
    <a href="#ui%20size." name="ui%20size." class="pilcrow">&#182;</a>
    UI Size.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>

    <span class="kd">function</span> <span class="nx">getWindowSize</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">clientName</span><span class="p">;</span>
        <span class="nx">assert</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">name</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;pklib.ui.size.window: @name: not {string}&#39;</span><span class="p">);</span>

        <span class="nx">name</span> <span class="o">=</span> <span class="nx">capitalize</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
        <span class="nx">clientName</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">[</span><span class="s1">&#39;client&#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">];</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">compatMode</span> <span class="o">===</span> <span class="s1">&#39;CSS1Compat&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">clientName</span><span class="p">)</span> <span class="o">||</span>
            <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">[</span><span class="s1">&#39;client&#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">]</span> <span class="o">||</span>
            <span class="nx">clientName</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">getDocumentSize</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">clientName</span><span class="p">,</span>
            <span class="nx">scrollBodyName</span><span class="p">,</span>
            <span class="nx">scrollName</span><span class="p">,</span>
            <span class="nx">offsetBodyName</span><span class="p">,</span>
            <span class="nx">offsetName</span><span class="p">;</span>

        <span class="nx">assert</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">name</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;pklib.ui.size.document: @name: not {string}&#39;</span><span class="p">);</span>

        <span class="nx">name</span> <span class="o">=</span> <span class="nx">capitalize</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
        <span class="nx">clientName</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">[</span><span class="s1">&#39;client&#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">];</span>
        <span class="nx">scrollBodyName</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">[</span><span class="s1">&#39;scroll&#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">];</span>
        <span class="nx">scrollName</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">[</span><span class="s1">&#39;scroll&#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">];</span>
        <span class="nx">offsetBodyName</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">[</span><span class="s1">&#39;offset&#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">];</span>
        <span class="nx">offsetName</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">[</span><span class="s1">&#39;offset&#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">];</span>
        <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">clientName</span><span class="p">,</span> <span class="nx">scrollBodyName</span><span class="p">,</span> <span class="nx">scrollName</span><span class="p">,</span> <span class="nx">offsetBodyName</span><span class="p">,</span> <span class="nx">offsetName</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">getObjectSize</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">assert</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">name</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;pklib.ui.size.object: @name: not {string}&#39;</span><span class="p">);</span>
        <span class="nx">assert</span><span class="p">(</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">obj</span><span class="p">),</span> <span class="s1">&#39;pklib.ui.size.object: @obj: not {HTMLElement}&#39;</span><span class="p">);</span>

        <span class="nx">name</span> <span class="o">=</span> <span class="nx">capitalize</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">client</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="s1">&#39;client&#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">],</span>
            <span class="nx">scroll</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="s1">&#39;scroll&#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">],</span>
            <span class="nx">offset</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="s1">&#39;offset&#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">];</span>
        <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">client</span><span class="p">,</span> <span class="nx">scroll</span><span class="p">,</span> <span class="nx">offset</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">size</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nb">window</span><span class="o">:</span> <span class="nx">getWindowSize</span><span class="p">,</span>
        <span class="nb">document</span><span class="o">:</span> <span class="nx">getDocumentSize</span><span class="p">,</span>
        <span class="nx">object</span><span class="o">:</span> <span class="nx">getObjectSize</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="url.">
  <h2>
    <a href="#url." name="url." class="pilcrow">&#182;</a>
    URL.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-103" id="section-103">&#182;</a>
</div>
<p>Get all params, and return in JSON object.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getParams</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">item</span><span class="p">,</span> <span class="nx">len</span><span class="p">,</span> <span class="nx">key_value_section</span><span class="p">,</span> <span class="nx">params</span><span class="p">,</span> <span class="nx">params_list</span> <span class="o">=</span> <span class="p">{};</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">url</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">params</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/\?(.*)/</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">params</span> <span class="o">=</span> <span class="nx">root</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;?&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">params</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">params</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">);</span>
        <span class="nx">len</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">key_value_section</span> <span class="o">=</span> <span class="nx">params</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">key_value_section</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">item</span> <span class="o">=</span> <span class="nx">key_value_section</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">);</span>
                <span class="nx">params_list</span><span class="p">[</span><span class="nx">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">item</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">params_list</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-104" id="section-104">&#182;</a>
</div>
<p>Get concrete param from URL. If param if not defined return null.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getParam</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">params</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">item</span><span class="p">,</span> <span class="nx">len</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">url</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">params</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/\?(.*)/</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">params</span> <span class="o">=</span> <span class="nx">root</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;?&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">params</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">params</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">);</span>
        <span class="nx">len</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">item</span> <span class="o">=</span> <span class="nx">params</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">item</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">getParams</span><span class="o">:</span> <span class="nx">getParams</span><span class="p">,</span>
        <span class="nx">getParam</span><span class="o">:</span> <span class="nx">getParam</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="utilities.">
  <h2>
    <a href="#utilities." name="utilities." class="pilcrow">&#182;</a>
    Utilities.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>

    <span class="kd">function</span> <span class="nx">openTrigger</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">originalTarget</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">originalTarget</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">originalTarget</span><span class="p">.</span><span class="nx">href</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">url</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">originalTarget</span><span class="p">.</span><span class="nx">href</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">toElement</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">toElement</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">toElement</span><span class="p">.</span><span class="nx">href</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">url</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">toElement</span><span class="p">.</span><span class="nx">href</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">srcElement</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">srcElement</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">srcElement</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">url</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">srcElement</span><span class="p">.</span><span class="nx">href</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">root</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>

        <span class="k">try</span> <span class="p">{</span>
            <span class="nx">evt</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">ignore</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">root</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">clearFocus</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">obj</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">addEvent</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s1">&#39;focus&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">defaultValue</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">obj</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">});</span>
            <span class="nx">addEvent</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s1">&#39;blur&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">obj</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">defaultValue</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">outerlink</span><span class="p">(</span><span class="nx">area</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">len</span><span class="p">,</span> <span class="nx">link</span><span class="p">,</span> <span class="nx">links</span><span class="p">;</span>

        <span class="nx">area</span> <span class="o">=</span> <span class="nx">area</span> <span class="o">||</span> <span class="nb">document</span><span class="p">;</span>

        <span class="nx">links</span> <span class="o">=</span> <span class="nx">pklib</span><span class="p">.</span><span class="nx">dom</span><span class="p">.</span><span class="nx">by_tag</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="nx">area</span><span class="p">);</span>
        <span class="nx">len</span> <span class="o">=</span> <span class="nx">links</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">link</span> <span class="o">=</span> <span class="nx">links</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">link</span><span class="p">.</span><span class="nx">rel</span> <span class="o">===</span> <span class="s1">&#39;outerlink&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">addEvent</span><span class="p">(</span><span class="nx">link</span><span class="p">,</span> <span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="nx">openTrigger</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">link</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">confirm</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">text</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">response</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">element</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">text</span> <span class="o">=</span> <span class="nx">text</span> <span class="o">||</span> <span class="s1">&#39;Sure?&#39;</span><span class="p">;</span>

            <span class="nx">addEvent</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">response</span> <span class="o">=</span> <span class="nx">root</span><span class="p">.</span><span class="nx">confirm</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">try</span> <span class="p">{</span>
                        <span class="nx">evt</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
                    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">ignore</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">root</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                    <span class="p">}</span>

                    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">pklib</span><span class="p">.</span><span class="nx">utils</span> <span class="o">=</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-106" id="section-106">&#182;</a>
</div>
<p>Numbers of chars in ASCII system.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">ascii</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">letters</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">lower</span><span class="o">:</span> <span class="p">[</span><span class="mi">113</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span>
                    <span class="mi">115</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span>
                    <span class="mi">98</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">109</span><span class="p">],</span>
                <span class="nx">upper</span><span class="o">:</span> <span class="p">[</span><span class="mi">81</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span>
                    <span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">77</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span>

        <span class="nx">action</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">clearfocus</span><span class="o">:</span> <span class="nx">clearFocus</span><span class="p">,</span>
            <span class="nx">outerlink</span><span class="o">:</span> <span class="nx">outerlink</span><span class="p">,</span>
            <span class="nx">confirm</span><span class="o">:</span> <span class="nx">confirm</span>
        <span class="p">}</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-107" id="section-107">&#182;</a>
</div>
<p>Exports.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">root</span><span class="p">.</span><span class="nx">pklib</span> <span class="o">=</span> <span class="nx">pklib</span><span class="p">;</span>

<span class="p">}(</span><span class="k">this</span><span class="p">));</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
